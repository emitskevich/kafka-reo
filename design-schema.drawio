<mxfile host="drawio-plugin" modified="2023-02-06T01:50:59.209Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36" version="20.5.3" etag="6D5kdEhzZwfSw9dmltnJ" type="embed"><diagram id="nGLieXSFuladX91sqCkF" name="Page-1"><mxGraphModel dx="907" dy="649" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="34" value="Destination cluster" style="sketch=0;outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_region;strokeColor=#879196;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#879196;dashed=1;" vertex="1" parent="1"><mxGeometry x="380" y="300" width="410" height="200" as="geometry"/></mxCell><mxCell id="27" value="Source cluster" style="sketch=0;outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_region;strokeColor=#879196;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#879196;dashed=1;" vertex="1" parent="1"><mxGeometry x="20" y="300" width="120" height="200" as="geometry"/></mxCell><mxCell id="15" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1"><mxGeometry x="40" y="365" width="80" height="70" as="geometry"/></mxCell><mxCell id="16" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="15"><mxGeometry width="80" height="35" as="geometry"/></mxCell><mxCell id="17" value="&lt;b&gt;key&lt;/b&gt;:&lt;br&gt;original key" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="16"><mxGeometry width="80" height="35" as="geometry"><mxRectangle width="80" height="35" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="18" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="15"><mxGeometry y="35" width="80" height="35" as="geometry"/></mxCell><mxCell id="19" value="&lt;b&gt;value&lt;/b&gt;:&lt;br&gt;original value" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="18"><mxGeometry width="80" height="35" as="geometry"><mxRectangle width="80" height="35" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="20" value="wrapping and &lt;br&gt;repartitioning by &lt;br&gt;new compound key" style="endArrow=classic;html=1;rounded=0;startArrow=none;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="250" y="400" as="sourcePoint"/><mxPoint x="390" y="400" as="targetPoint"/></mxGeometry></mxCell><mxCell id="30" value="Step1:&lt;br&gt;consumer-producer&lt;br&gt;app" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.worker;fillColor=#D9A741;gradientColor=none;" vertex="1" parent="1"><mxGeometry x="180" y="368.5" width="60" height="63" as="geometry"/></mxCell><mxCell id="32" value="" style="endArrow=classic;html=1;rounded=0;startArrow=none;exitX=0.929;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="27"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="150" y="400" as="sourcePoint"/><mxPoint x="170" y="400" as="targetPoint"/></mxGeometry></mxCell><mxCell id="36" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1"><mxGeometry x="400" y="340" width="140" height="120" as="geometry"/></mxCell><mxCell id="37" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="36"><mxGeometry width="140" height="60" as="geometry"/></mxCell><mxCell id="38" value="&lt;b&gt;key&lt;/b&gt;:&lt;br&gt;source bootstrap servers&lt;br&gt;+ source topic name&lt;br&gt;+ source topic partition" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="37"><mxGeometry width="140" height="60" as="geometry"><mxRectangle width="140" height="60" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="39" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="36"><mxGeometry y="60" width="140" height="60" as="geometry"/></mxCell><mxCell id="40" value="&lt;b&gt;value&lt;/b&gt;:&lt;br&gt;original offset&lt;br&gt;+ original key&lt;br&gt;+ original value" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="39"><mxGeometry width="140" height="60" as="geometry"><mxRectangle width="140" height="60" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="41" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1"><mxGeometry x="690" y="365" width="80" height="70" as="geometry"/></mxCell><mxCell id="42" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="41"><mxGeometry width="80" height="35" as="geometry"/></mxCell><mxCell id="43" value="&lt;b&gt;key&lt;/b&gt;:&lt;br&gt;original key" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="42"><mxGeometry width="80" height="35" as="geometry"><mxRectangle width="80" height="35" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="44" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="41"><mxGeometry y="35" width="80" height="35" as="geometry"/></mxCell><mxCell id="45" value="&lt;b&gt;value&lt;/b&gt;:&lt;br&gt;original value" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="44"><mxGeometry width="80" height="35" as="geometry"><mxRectangle width="80" height="35" as="alternateBounds"/></mxGeometry></mxCell><mxCell id="46" value="unwrapping and &lt;br&gt;repartitioning by &lt;br&gt;original key" style="endArrow=classic;html=1;rounded=0;startArrow=none;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="660" y="200" as="sourcePoint"/><mxPoint x="730" y="360" as="targetPoint"/><Array as="points"><mxPoint x="730" y="200"/></Array></mxGeometry></mxCell><mxCell id="47" value="Step 2:&lt;br&gt;Kafka Streams&lt;br&gt;app" style="outlineConnect=0;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;shape=mxgraph.aws3.worker;fillColor=#D9A741;gradientColor=none;" vertex="1" parent="1"><mxGeometry x="589" y="168.5" width="60" height="63" as="geometry"/></mxCell><mxCell id="48" value="" style="endArrow=classic;html=1;rounded=0;startArrow=none;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="550" y="400" as="sourcePoint"/><mxPoint x="620" y="290" as="targetPoint"/><Array as="points"><mxPoint x="620" y="400"/></Array></mxGeometry></mxCell><mxCell id="49" value="Kafka Streams state store" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.database;whiteSpace=wrap;" vertex="1" parent="1"><mxGeometry x="424" y="150" width="85" height="100" as="geometry"/></mxCell><mxCell id="51" value="Stores the largest ever observed original offset by compound key" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1"><mxGeometry x="380" y="47.5" width="112.5" height="60" as="geometry"/></mxCell><mxCell id="52" value="Fetches the largest observed offset from state store and compares with the value from the current message. If the current value is strictly larger than one ever observed, the message is written to output and state store is updated. Otherwise, the message is duplicate and is dropped.&lt;br&gt;&lt;b&gt;exactly-once&lt;/b&gt;." style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1"><mxGeometry x="540" y="20" width="275" height="100" as="geometry"/></mxCell><mxCell id="53" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="584" y="220" as="sourcePoint"/><mxPoint x="514" y="220" as="targetPoint"/></mxGeometry></mxCell><mxCell id="54" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="514" y="190" as="sourcePoint"/><mxPoint x="584" y="190" as="targetPoint"/></mxGeometry></mxCell><mxCell id="56" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="463" y="140" as="sourcePoint"/><mxPoint x="436" y="110" as="targetPoint"/></mxGeometry></mxCell><mxCell id="57" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" edge="1" parent="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="630" y="160" as="sourcePoint"/><mxPoint x="670" y="130" as="targetPoint"/></mxGeometry></mxCell><mxCell id="59" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" edge="1" parent="1" target="60"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="210" y="360" as="sourcePoint"/><mxPoint x="440" y="230" as="targetPoint"/></mxGeometry></mxCell><mxCell id="60" value="Copies messages with &lt;b&gt;at-least-once &lt;/b&gt;guarantee" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1"><mxGeometry x="110" y="140" width="90" height="70" as="geometry"/></mxCell><mxCell id="61" value="Resulting topic" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1"><mxGeometry x="610" y="520" width="110" height="30" as="geometry"/></mxCell><mxCell id="62" value="Auxiliary topic" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1"><mxGeometry x="460" y="520" width="100" height="30" as="geometry"/></mxCell><mxCell id="63" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" target="62"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="470" y="470" as="sourcePoint"/><mxPoint x="450" y="300" as="targetPoint"/></mxGeometry></mxCell><mxCell id="64" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" target="61"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="730" y="450" as="sourcePoint"/><mxPoint x="450" y="300" as="targetPoint"/></mxGeometry></mxCell><mxCell id="65" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="66"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="150" y="530" as="sourcePoint"/><mxPoint x="80" y="440" as="targetPoint"/></mxGeometry></mxCell><mxCell id="66" value="Source topic" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1"><mxGeometry x="70" y="520" width="90" height="30" as="geometry"/></mxCell></root></mxGraphModel></diagram></mxfile>